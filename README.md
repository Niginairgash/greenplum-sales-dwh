# –¶–µ–ª—å –¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–∑–¥–∞—Ç—å dwh.

–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:
–≠—Ç–æ—Ç pet-–ø—Ä–æ–µ–∫—Ç –º–æ–¥–µ–ª–∏—Ä—É–µ—Ç —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö (DWH) c –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Data Vault 2.0. –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ CSV-—Ñ–∞–π–ª–æ–≤ –≤ Greenplum, –∑–∞—Ç–µ–º –∞–≥—Ä–µ–≥–∏—Ä—É—é—Ç—Å—è –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è.

üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:
- data
    - categories.csv
    - products.csv
    - customers.csv
    - sales.csv
- sql
    
- scripts
    
README.md

üìä Data Vault 2.0 –º–æ–¥–µ–ª—å
–ü—Ä–æ–µ–∫—Ç –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Data Vault 2.0 –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö
* –•–∞–±-—Ç–∞–±–ª–∏—Ü—ã
* –õ–∏–Ω–∫-—Ç–∞–±–ª–∏—Ü—ã
* –°–∞—Ç–µ–ª–ª–∏—Ç-—Ç–∞–±–ª–∏—Ü—ã

üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
* Greenplum Database (MPP -—Ö—Ä–∞–Ω–∏–ª–∏—â–µ)
* PostgreSQL (–æ—Å–Ω–æ–≤–∞ Greenplum)
* Docker (—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ)
* Python (pandas, facker) (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö)

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Docker 
 –∑–∞–ø—É—Å–∫–∞–µ–º  docker-compose:
    docker compose up
    

# Data Vault 
## —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
    - ods - –°–ª–æ–π –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        * –î–∞–Ω–Ω—ã–µ –Ω–µ –æ—á–∏—â–µ–Ω—ã –∏ –Ω–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω—ã
        * –î–∞–Ω–Ω—ã–µ —É–ª–æ–∂–µ–Ω—ã –≤ —Ç–∞–±–ª–∏—Ü—ã —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ç–∏–ø–æ–≤
        * –î–∞–Ω–Ω—ã–µ –æ–±–æ–≥–∞—â–µ–Ω—ã —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π (–¥–∞—Ç–∞ –∑–∞–≥—Ä—É–∑–∫–∏, –∫–æ–¥ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏ —Ç.–¥.)
        * –ü–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤–µ–¥–µ—Ç—Å—è –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è (SCD2)
    - dds - —Å–ª–æ–π –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        * –î–∞–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã
        * –î–∞–Ω–Ω—ã–µ —É–ª–æ–∂–µ–Ω—ã –≤ –æ–¥–Ω—É –æ–±—ä–µ–∫—Ç–Ω—É—é –º–æ–¥–µ–ª—å –∏ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –∫ DataVault
        * –î–∞–Ω–Ω—ã–µ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã
    - ads - —Å–ª–æ–π –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –≤–∏—Ç—Ä–∏–Ω
        * –î–∞–Ω–Ω—ã–µ —É–ª–æ–∂–µ–Ω—ã –≤ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –±–∏–∑–Ω–µ—Å-–º–æ–¥–µ–ª–∏
        * –ù–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –±–∏–∑–Ω–µ—Å-–æ–±–ª–∞—Å—Ç—å—é
        * –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ - BI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –æ—Ç—á–µ—Ç—ã

## –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å 
1. –°–æ–∑–¥–∞—Ç—å —Å—Ö–µ–º—É –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:
    ```sql
    create schema ods;
    create schema dds;
    create schema ads;

## –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö
    –í –∫–∞—á–µ—Å—Ç–≤–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–∏—Å—Ç–µ–º–∞ —É—á–µ—Ç–∞ –ø—Ä–æ–¥–∞–∂ –ò–¢-–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è. 
    –î–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ –≤–∏–¥–µ CSV-—Ñ–∞–π–ª–æ–≤ –∏ –≤–∫–ª—é—á–∞—é—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ:
        - –∑–∞–∫–∞–∑–∞—Ö
        - –∫–ª–∏–µ–Ω—Ç–∞—Ö
        - —Ç–æ–≤–∞—Ä–∞—Ö
        - –æ–ø–ª–∞—Ç–∞—Ö –∏ –ø–æ—Å—Ç–∞–≤–∫–∞—Ö

## –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Greenplum —á–µ—Ä–µ–∑ Python –≤ Airflow
    –ß—Ç–æ–±—ã –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Greenplum —á–µ—Ä–µ–∑ Python –≤ Airflow, –Ω–∞–º –Ω—É–∂–Ω–æ:
    1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω—É–∂–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
        pip install apache-airflow[postgres] psycopg2-binary
    2. –°–æ–∑–¥–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤ Airflow UI
        1. –û—Ç–∫—Ä—ã–≤–∞–µ–º Airflow web UI (localhost:8080)
        2. –ü–µ—Ä–µ—Ö–æ–¥–∏–º Admin -> Connection
        ![alt text](image.png)
        3. –ù–∞–∂–∏–º–∞–µ–º + Add
        4. –ó–∞–ø–æ–ª–Ω—è–µ–º —Ç–∞–∫:
            * Conn Id:
            * Conn Type:
            * Host:
            * Schema: 
            * Login:
            * Password:
            * Port: 5432 